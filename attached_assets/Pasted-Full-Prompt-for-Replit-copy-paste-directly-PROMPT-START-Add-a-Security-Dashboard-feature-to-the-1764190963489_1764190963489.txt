Full Prompt for Replit (copy/paste directly):

PROMPT START

Add a Security Dashboard feature to the NexusComs backend UI.
Implement it inside the existing Express.js backend and admin dashboard.
The goal is to provide a full internal security suite with real-time monitoring.

1. Create a new backend route group

Create a new route file:

backend/src/routes/security.js


Expose these endpoints:

1.1 Secret & Credential Scanner

Endpoint: GET /security/scan-secrets

Function:

Scan the entire repo directory (excluding node_modules, build, .git) for patterns of secrets:

API keys

JWT secrets

Private keys

Passwords

Stream API keys

Supabase keys

Any .env* files

Return JSON with:

Files flagged

Line numbers

Severity score

Suggested remediation

Use a small regex-based scanner in Node.js (no external binaries required).

1.2 Dependency Vulnerability Audit

Endpoint: GET /security/npm-audit

Function:

Execute npm audit --json programmatically on the server

Parse results

Return:

Vulnerability counts by severity

List of vulnerable packages

Recommended fixes

Whether automatic fixes are available

1.3 API Traffic Monitor

Endpoint: GET /security/api-traffic

Function:

Return:

Incoming requests per endpoint (last 10 minutes, last 60 minutes)

Error rate

Suspicious request patterns

Rate-limit warnings

IPs with repeated failures

Use an in-memory store (Map or Redis if available) to track metrics

1.4 System Integrity Checker

Endpoint: GET /security/integrity

Function:

Detect modified core backend files since last restart

Compare hashes of monitored files

Report anomalies

1.5 Security Recommendations Endpoint

Endpoint: GET /security/recommendations

Provide actionable improvements based on:

Missing Helmet config

Missing rate-limiting

HTTP-only / Secure cookie flags

CORS issues

Unsecured secrets

Dependency risk score

2. Add Security Middleware for Live Monitoring

Implement middleware in:

backend/src/middleware/securityMonitor.js


Middleware functions:

Log every request (path, IP, status, duration)

Detect:

Spike in traffic

Same IP making too many requests

Suspicious user agents

Repeated 401/403 attempts

Store metrics in memory

Expose metrics to /security/api-traffic

3. Add a Security Tab in the Admin Dashboard UI

Update your backend dashboard React/HTML view (whichever you use) and add a new tab:

“Security” Tab Components

Secrets Scanner Panel

Table of flagged files & severity

Button: “Run Secret Scan”

Dependency Audit Panel

Graph or table of vulnerabilities

Button: “Run npm audit”

API Traffic Monitor

Live charts:

Requests per minute

Error rate

Suspicious IPs

System Integrity Panel

File hash comparison

Status indicator: green/yellow/red

Recommended Fixes Panel

List of prioritized issues

Each with:

Explanation

Suggested fix

Button to view related code

UI should call the endpoints created above.

4. Add configurable alerting

Inside backend/src/utils/alerts.js:

Implement an alert manager that:

Triggers alerts if:

Secret leak detected

Vulnerabilities > threshold

Traffic spike ×3 increase in < 30 seconds

Error rate > 10%

Alerts logged to:

JSON log file /logs/security-alerts.log

Returned to UI via endpoint:

GET /security/alerts

5. Update app.js to register the routes

In backend/src/app.js:

const securityRoutes = require('./routes/security');
app.use('/security', securityRoutes);


Also mount the monitoring middleware.

6. Ensure no sensitive data is returned

Before returning scan results:

Mask keys

Never return full secret values

Only show patterns like “••••••KEY_END”

7. Provide demo data mode

If running on Replit where some system calls may be restricted:

Provide “safe fallback mode”

Return mocked metrics instead of failing

8. Add documentation

Create:

backend/docs/security-dashboard.md


Explain each audit tool and endpoint.

Please generate all backend code, UI changes, files, and boilerplate required to implement the complete Security Dashboard system described above.