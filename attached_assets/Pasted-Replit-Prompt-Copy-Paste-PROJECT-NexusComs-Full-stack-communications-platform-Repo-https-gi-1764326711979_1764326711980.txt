Replit Prompt (Copy/Paste)

PROJECT:
NexusComs – Full-stack communications platform
Repo: https://github.com/Jays-Network/NexusComs

TASK:
Fully remove GetStream.io from the entire codebase and replace it with CometChat for all chat, messaging, channel, user-sync, and real-time event functionality.
Implement CometChat in a production-ready, secure, and scalable way across:

Frontend (Next.js / React)

Backend (Node / API routes / server utilities / auth hooks)

Supabase (user profiles, metadata, tokens, and role management)

OUTPUT REQUIREMENTS:

Update all files containing GetStream logic, imports, tokens, environment variables, API interactions, and UI integrations.

Ensure the final implementation is stable, consistent, modular, and follows security best practices.

No placeholder code. No incomplete stubs.

All code must run without errors after the migration.

Provide commit-ready final code modifications or full file rewrites when required.

DETAILED IMPLEMENTATION INSTRUCTIONS
1. Remove all GetStream references

Search and eliminate:

stream-chat

getstream

StreamChat

Stream client instances

Stream channel creation logic

Stream user token generation code

Any Stream webhooks, roles, or moderation logic

Stream environment variables from .env.*

2. Install and configure CometChat

Implement the official SDK:

@cometchat-pro/chat for frontend

cometchat-pro server-side Node SDK for backend secure operations

Create a new config module:

/lib/cometchat.ts


containing:

initialization

auth token generation helpers

user creation helper

group/channels creation helpers

3. Replace Stream backend logic with CometChat equivalents

Update API endpoints for:

user creation → CometChat createUser

user login → CometChat login

server-side tokens → CometChat generateAuthToken

channel management → CometChat groups API

role or permission mapping

message history retrieval

real-time events via CometChat’s WebSockets

Ensure:

All backend security follows CometChat’s server authentication model

No client-side secret exposure

4. Update Supabase for CometChat sync

Modify tables to store:

cometchat_uid

mapped group/channel IDs

CometChat auth tokens (server generated)

realtime preference fields if needed

Update Supabase triggers or RLS rules accordingly:

Users must have valid CometChat UID

Ensure row-level security prevents cross-user chat leakage

5. Replace all frontend Stream UI with CometChat UI

Implement:

CometChatUI Kit components
OR

Custom components built on top of the CometChat SDK

Replace:

Stream ChannelList → CometChat GroupList

Stream MessageList → CometChat MessageList

Stream ChannelHeader → CometChat Header

Stream MessageInput → CometChat Input

Ensure:

Typing indicators, read receipts, presence indicators, file uploads, and thumbnails work

Real-time updates handled through CometChat listeners

6. Update environment variables

Remove all Stream variables and replace with:

COMETCHAT_APP_ID=
COMETCHAT_REGION=
COMETCHAT_AUTH_KEY=
COMETCHAT_API_KEY=        # server-side only
COMETCHAT_APP_SECRET=     # if applicable, server-side only


Enforce:

Only server-side code may use API keys

Frontend receives only temporary auth tokens delivered via secure API

7. Replace all Stream business logic

Replace Stream logic in:

Authentication flow

Channel creation workflow

DM creation workflow

User-state synchronization

Notifications and event handlers

Ensure:

All logic is rewritten using CometChat listeners and the CometChat.init lifecycle

No deprecated or unused Stream code remains

8. Update documentation and comments

Provide:

Revised README sections

Updated environment variable instructions

Brief migration notes inside the repo

SUCCESS CRITERIA

The migration is complete when:

No GetStream dependencies exist in the project.

All chat features fully work using CometChat.

Authentication, permissions, and user sync remain functional.

The app builds and runs without errors on:

local dev

production builds

deployments on your existing hosting setup

All environment variables, backend routes, and frontend components operate using CometChat exclusively.

Code quality is production-grade and stable.